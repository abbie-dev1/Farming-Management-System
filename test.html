<!doctype html>
<html lang="en">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""/>
<!-- Make sure you put this AFTER Leaflet's CSS -->
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>
<style>#mapid { height: 500px; }</style>
<body>
<div id="mapid" class="map"></div>
<script type="text/javascript">
    mapboxgl.accessToken = 'pk.eyJ1IjoiZ29sZHdpbmZhbmEiLCJhIjoiY2tsamJoZHdhMjd2NDJ6bWdvemxydWMzOCJ9.N4lxy0RwuwipREz3-sDacw';



    // var mymap = L.map('mapid').setView([-25.7539834,28.1962637], 13);
    //
    // L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
    //     attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
    //     maxZoom: 18,
    //     id: 'mapbox/streets-v11',
    //     tileSize: 512,
    //     zoomOffset: -1,
    //     accessToken: 'pk.eyJ1IjoiZ29sZHdpbmZhbmEiLCJhIjoiY2tsamJoZHdhMjd2NDJ6bWdvemxydWMzOCJ9.N4lxy0RwuwipREz3-sDacw'
    // }).addTo(mymap);

    var map = L.map('mapid', {
        'center': [0, 0],
        'zoom': 0,
        'layers': [
            L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'
            })
        ]
    });

    var markers = {};

    function setMarkers(data) {
        data.BMS.forEach(function (obj) {
            if (!markers.hasOwnProperty(obj.id)) {
                markers[obj.id] = new L.Marker([obj.lat, obj.long]).addTo(map);
                markers[obj.id].previousLatLngs = [];
            } else {
                markers[obj.id].previousLatLngs.push(markers[obj.id].getLatLng());
                markers[obj.id].setLatLng([obj.lat, obj.long]);
            }
        });
    }



    var updatedJson = {
        "BMS":[{
            "id": 'id1',
            "lat": -45,
            "long": 45
        },{
            "id": 'id22',
            "lat": 45,
            "long": 45
        }]
    }

    setTimeout(function () {
        setMarkers(updatedJson);
    }, 3000);

    //console.log(markers);

    // var locations = [
    //     [-25.7539834, 28.1962637],
    //     [-25.7539835, 28.19626999],
    //     [10.7202, 122.5621],
    //     [11.3889, 122.6277],
    //     [10.5929, 122.6325]
    // ];
    //
    // for (var i=0; i<locations.length; i++){
    //
    //     var icon = L.divIcon({
    //         className: 'custom-div-icon',
    //         html: "<img src='assets/img/mobile.png' width='30' height='20'>",
    //         iconSize: [30, 42],
    //         iconAnchor: [15, 42]
    //     });
    //
    //     marker = new L.marker(L.latLng([locations[i][0], locations[i][1]]),{
    //         icon: icon,title:'kjkjkj'
    //     });
    //
    //     marker.addTo(mymap);
    //
    // }
    //
    // setTimeout(function () {
    //     var lat = -25.731340;
    //     var lng = 28.218370;
    //     var newLatLng = new L.LatLng(lat, lng);
    //     mymap.setLatLng(newLatLng);
    // },5000)


    //var marker = L.marker([51.5, -0.09]).addTo(mymap);
</script>
</body>
</html>